cmake_minimum_required(VERSION 3.16)
project(PBL2_Gym)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ============================================================================
# SFML Configuration - DÙNG STATIC
# ============================================================================
set(SFML_DIR "C:/SFML_Build/lib/cmake/SFML")
set(SFML_STATIC_LIBRARIES ON)

find_package(SFML 3 REQUIRED COMPONENTS Graphics Window System)

# ============================================================================
# INCLUDE PATHS TOÀN CỤC
# ============================================================================
include_directories(
    ${CMAKE_CURRENT_SOURCE_DIR}/Include
    ${CMAKE_CURRENT_SOURCE_DIR}/Include/Models
    ${CMAKE_CURRENT_SOURCE_DIR}/Include/Managers
    ${CMAKE_CURRENT_SOURCE_DIR}/Include/Controllers
    ${CMAKE_CURRENT_SOURCE_DIR}/Include/Utils
    # ${CMAKE_CURRENT_SOURCE_DIR}/Include/UI
)

# ============================================================================
# SOURCE FILES
# ============================================================================
file(GLOB_RECURSE SRC_FILES 
    "${CMAKE_CURRENT_SOURCE_DIR}/Src/*.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/Src/*.tpp"
)

include_directories(
    ${CMAKE_CURRENT_SOURCE_DIR}/Frontend/Include
    ${CMAKE_CURRENT_SOURCE_DIR}/Frontend/Include/Manager
    ${CMAKE_CURRENT_SOURCE_DIR}/Frontend/Include/Screens
    ${CMAKE_CURRENT_SOURCE_DIR}/Frontend/Include/UI
)

file(GLOB_RECURSE FRONTEND_FILES
    "${CMAKE_CURRENT_SOURCE_DIR}/Frontend/Source/Manager/*.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/Frontend/Source/Screens/*.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/Frontend/Source/UI/*.cpp"
)

add_executable(PBL2_Gym 
    main.cpp
    ${SRC_FILES}
    ${FRONTEND_FILES}
)

# ============================================================================
# LINKING SFML
# ============================================================================
target_compile_definitions(PBL2_Gym PRIVATE SFML_STATIC)

target_link_libraries(PBL2_Gym PRIVATE 
    SFML::Graphics 
    SFML::Window 
    SFML::System
)

if(WIN32 AND SFML_STATIC_LIBRARIES)
    target_link_libraries(PBL2_Gym PRIVATE 
        winmm
        opengl32
        gdi32
    )
endif()

# ============================================================================
# FIX FREETYPE ISSUE
# ============================================================================
if(TARGET freetype)
    get_target_property(freetype_include_dirs freetype INTERFACE_INCLUDE_DIRECTORIES)
    if(freetype_include_dirs)
        list(FILTER freetype_include_dirs EXCLUDE REGEX ".*freetype2.*")
        set_target_properties(freetype PROPERTIES INTERFACE_INCLUDE_DIRECTORIES "${freetype_include_dirs}")
    endif()
endif()
